@model IndexModel

<!-- Plant Cards -->
<div id="plant-list">
    <div class="row plants-grid stagger-animation">
        @Html.AntiForgeryToken()

        @foreach (DTOs.PlantListDTO plant in Model.Plants.Items)
        {
            <div class="col-xl-3 col-lg-4 col-md-6 mb-4">
                <div class="card plant-card h-100">
                    <div class="plant-image">
                        @if (plant.ImageUrls != null && plant.ImageUrls.Any())
                        {
                            <img src="@plant.ImageUrls.First()" alt="@plant.CommonName">
                        }
                        else
                        {
                            <div class="plant-image-placeholder">
                                <i class="bi bi-image"></i>
                            </div>
                        }
                    </div>
                    <div class="card-body d-flex flex-column">
                        <h5 class="plant-title">@plant.CommonName</h5>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="plant-species">@plant.SpeciesName</small>
                            @if (plant.IsActive == true)
                            {
                                <span class="category-badge border border-success text-success bg-success-light px-2 py-1">
                                    <i class="bi bi-check-circle"></i> Active
                                </span>
                            }
                            else
                            {
                                <span class="category-badge border border-danger text-danger bg-danger-light px-2 py-1">
                                    <i class="bi bi-x-circle"></i>InActive
                                </span>                                                                                                                                                                                                     
                            }
                        </div>
                        @* <p class="plant-description">@plant.Description</p> *@
                        <div class="category-badges mt-auto">
                            @foreach (var categoryName in plant.CategoryNames)
                            {
                                <span class="category-badge">@categoryName</span>
                            }
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="action-buttons">
                            <a asp-page="/Admin/Update" asp-route-id="@plant.PlantId" class="action-btn btn-edit">
                                <i class="bi bi-pencil-square"></i> Sửa
                            </a>
                            <button type="button" class="action-btn btn-delete toggle-active-btn" data-id="@plant.PlantId">
                                <i class="bi bi-trash"></i> @(plant.IsActive == true ? "Ẩn" : "Hiện")
                            </button>

                            <a asp-page="/Detail" asp-route-id="@plant.PlantId" class="action-btn btn-view">
                                <i class="bi bi-eye"></i> Chi tiết
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Pagination -->
    @if (Model.TotalPages > 1)
    {
        <div class="pagination-wrapper">
            <nav aria-label="Phân trang" id="pagination">
                <ul class="pagination mb-0">
                    <li class="page-item @(Model.CurrentPage <= 1 ? "disabled" : "")">
                        <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage - 1)">
                            <i class="bi bi-chevron-left"></i> Trước
                        </a>
                    </li>
                    @{
                        int start = Math.Max(1, Model.CurrentPage - 2);
                        int end = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
                        if (Model.CurrentPage <= 3)
                        {
                            start = 1;
                            end = Math.Min(5, Model.TotalPages);
                        }
                        else if (Model.CurrentPage >= Model.TotalPages - 2)
                        {
                            end = Model.TotalPages;
                            start = Math.Max(1, Model.TotalPages - 4);
                        }
                    }
                    @if (start > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="1">1</a>
                        </li>
                        <li class="page-item disabled"><span class="page-link">...</span></li>
                    }
                    @for (int i = start; i <= end; i++)
                    {
                        <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                            <a class="page-link" href="javascript:void(0)" data-page="@i">@i</a>
                        </li>
                    }
                    @if (end < Model.TotalPages)
                    {
                        <li class="page-item disabled"><span class="page-link">...</span></li>
                        <li class="page-item">
                            <a class="page-link" href="javascript:void(0)" data-page="@Model.TotalPages">@Model.TotalPages</a>
                        </li>
                    }
                    <li class="page-item @(Model.CurrentPage >= Model.TotalPages ? "disabled" : "")">
                        <a class="page-link" href="javascript:void(0)" data-page="@(Model.CurrentPage + 1)">
                            Sau <i class="bi bi-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    }
</div>